import GameSettings from '../../settings.js'

class RoadDataStructure {

    /**
     * This class contains all the geometric data for each road type
     * 
     * @param { Array } vertices A list of x, y, and z point to make vertices.
     * 
     * [
     *      x, y, z, <-----\
     *      x, y, z, <-----|----- Face <-----\
     *      x, y, z, <----/                  |----- Quad
     *      x, y, z, <-----\                 |
     *      x, y, z, <-----|----- Face <----/
     *      x, y, z, <----/
     * ]
     * 
     * @param { Array } sidewalkIndexes Each index represents a face, NOT QUAD, (by iteration) in the <vertices> array.
     * 
     * [ 0, 1, 2, 3, 6, 7, 8, 9 ]
     * 
     * @param { Array } pavementIndexes Each index represents a face, NOT QUAD, (by iteration) in the <vertices> array.
     * 
     * [ 5, 6 ]
     * 
     */

    constructor ( vertices, pavementIndexes, sidewalkIndexes ) {

        this.pavementIndexes = pavementIndexes
        this.sidewalkIndexes = sidewalkIndexes
        this.vertices = vertices

    }

    getRoadOffsets ( tilesLeft = 0, tilesUp = 0 ) {

        return new Promise( ( resolve ) => {

            const worker = new Worker( './scripts/game/transit/roads/offsets.worker.js' )

            worker.postMessage( [ 
                GameSettings.terrain.offset,
                GameSettings.roads.pavement.offset,
                GameSettings.roads.sidewalk.offset,
                GameSettings.terrain.tile.diameter,
                tilesLeft,
                tilesUp,
                this.vertices
            ] )

            worker.onmessage = ( e ) => {

                resolve( e.data[ 0 ] )

            }

        } )

    }

    getColors () {

        return new Promise( ( resolve ) => {

            const worker = new Worker( './scripts/game/transit/roads/colors.worker.js', {
                type: 'module',
            } )

            worker.postMessage( [
                this.pavementIndexes,
                this.sidewalkIndexes,
                this.vertices.length
            ] )

            worker.onmessage = ( e ) => {

                resolve( e.data[ 0 ] )

            }

        } )

    }

}

const RoadData = {

    // east - west

    ew: new RoadDataStructure( [

        // sidewalk

        -2, 0.25, -2,
        -2, 0, -2,
        2, 0, -2,
        2, 0, -2,
        2, 0.25, -2,
        -2, 0.25, -2,

        -2, 0.25, -2,
        -2, 0.25, -1.25,
        2, 0.25, -1.25,
        2, 0.25, -1.25,
        2, 0.25, -2,
        -2, 0.25, -2,

        -2, 0.25, -1.25,
        -2, 0.125, -1.25,
        2, 0.125, -1.25,
        2, 0.125, -1.25,
        2, 0.25, -1.25,
        -2, 0.25, -1.25,

        // pavement

        -2, 0.125, -1.25,
        -2, 0.125, 1.25,
        2, 0.125, 1.25,
        2, 0.125, 1.25,
        2, 0.125, -1.25,
        -2, 0.125, -1.25,

        // sidewalk

        -2, 0.25, 1.25,
        -2, 0.125, 1.25,
        2, 0.125, 1.25,
        2, 0.125, 1.25,
        2, 0.25, 1.25,
        -2, 0.25, 1.25,

        -2, 0.25, 2,
        -2, 0, 2,
        2, 0, 2,
        2, 0, 2,
        2, 0.25, 2,
        -2, 0.25, 2,

        -2, 0.25, 2,
        -2, 0.25, 1.25,
        2, 0.25, 1.25,
        2, 0.25, 1.25,
        2, 0.25, 2,
        -2, 0.25, 2,

    ], [ 6, 7 ], [ 0, 1, 2, 3, 2, 5, 8, 9, 10, 11, 12, 13 ] ),

    // north - south

    ns: [

        // sidewalk

        -2, 0.25, -2,
        -2, 0, -2,
        -2, 0, 2,
        -2, 0, 2,
        -2, 0.25, 2,
        -2, 0.25, -2,

        -2, 0.25, -2,
        -1.25, 0.25, -2,
        -1.25, 0.25, 2,
        -1.25, 0.25, 2,
        -2, 0.25, 2,
        -2, 0.25, -2,

        -1.25, 0.25, -2,
        -1.25, 0.125, -2,
        -1.25, 0.125, 2,
        -1.25, 0.125, 2,
        -1.25, 0.25, 2,
        -1.25, 0.25, -2,

        // pavement

        -1.25, 0.125, -2,
        1.25, 0.125, -2,
        1.25, 0.125, 2,
        1.25, 0.125, 2,
        -1.25, 0.125, 2,
        -1.25, 0.125, -2,

        // sidewalk

        1.25, 0.25, -2,
        1.25, 0.125, -2,
        1.25, 0.125, 2,
        1.25, 0.125, 2,
        1.25, 0.25, 2,
        1.25, 0.25, -2,

        2, 0.25, -2,
        2, 0, -2,
        2, 0, 2,
        2, 0, 2,
        2, 0.25, 2,
        2, 0.25, -2,

        2, 0.25, -2,
        1.25, 0.25, -2,
        1.25, 0.25, 2,
        1.25, 0.25, 2,
        2, 0.25, 2,
        2, 0.25, -2,

    ],

    // north - east

    ne: new RoadDataStructure( [

        // sidewalk

        2, 0.25, 2,
        2, 0, 2,
        -2, 0, 2,
        -2, 0, 2,
        -2, 0.25, 2,
        2, 0.25, 2,

        2, 0.25, 2,
        2, 0, 2,
        2, 0, -2,
        2, 0, -2,
        2, 0.25, -2,
        2, 0.25, 2,

        1.25, 0.25, 1.25,
        1.25, 0.125, 1.25,
        -2, 0.125, 1.25,
        -2, 0.125, 1.25,
        -2, 0.25, 1.25,
        1.25, 0.25, 1.25,

        1.25, 0.25, 1.25,
        1.25, 0.125, 1.25,
        1.25, 0.125, -2,
        1.25, 0.125, -2,
        1.25, 0.25, -2,
        1.25, 0.25, 1.25,

        -2, 0.25, 2,
        1.25, 0.25, 1.25,
        2, 0.25, 2,
        -2, 0.25, 2,
        -2, 0.25, 1.25,
        1.25, 0.25, 1.25,

        2, 0.25, -2,
        1.25, 0.25, 1.25,
        2, 0.25, 2,
        2, 0.25, -2,
        1.25, 0.25, -2,
        1.25, 0.25, 1.25,

        // pavement

        -2, 0.125, 1.25,
            -1.25, 0.125, -1.25,
            1.25, 0.125, 1.25,
            -2, 0.125, 1.25,
            -2, 0.125, -1.25,
            -1.25, 0.125, -1.25,
        
        1.25, 0.125, -2,
        -1.25, 0.125, -1.25,
        1.25, 0.125, 1.25,
        1.25, 0.125, -2,
        -1.25, 0.125, -2,
        -1.25, 0.125, -1.25,

        // sidewalk

        -2, 0.25, -1.25,
        -2, 0.125, -1.25,
        -1.25, 0.125, -1.25,
        -1.25, 0.125, -1.25,
        -1.25, 0.25, -1.25,
        -2, 0.25, -1.25,

        -1.25, 0.25, -2,
        -1.25, 0.125, -2,
        -1.25, 0.125, -1.25,
        -1.25, 0.125, -1.25,
        -1.25, 0.25, -1.25,
        -1.25, 0.25, -2,

        -2, 0.25, -1.25,
        -2, 0.25, -2,
        -1.25, 0.25, -1.25,
        -1.25, 0.25, -2,
        -2, 0.25, -2,
        -1.25, 0.25, -1.25,

    ], [ 12, 13, 14, 15 ], [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 16, 17, 18, 19, 20, 21 ] ),

    // north - west

    nw: new RoadDataStructure( [

        // sidewalk

        -2, 0.25, -2,
        -2, 0, -2,
        -2, 0, 2,
        -2, 0, 2,
        -2, 0.25, 2,
        -2, 0.25, -2,

        -2, 0.25, 2,
        -2, 0, 2,
        2, 0, 2,
        2, 0, 2,
        2, 0.25, 2,
        -2, 0.25, 2,

        2, 0.25, 1.25,
        2, 0.125, 1.25,
        -1.25, 0.125, 1.25,
        -1.25, 0.125, 1.25,
        -1.25, 0.25, 1.25,
        2, 0.25, 1.25,

        -1.25, 0.25, -2,
        -1.25, 0.125, -2,
        -1.25, 0.125, 1.25,
        -1.25, 0.125, 1.25,
        -1.25, 0.25, 1.25,
        -1.25, 0.25, -2,

        2, 0.25, 2,
        -1.25, 0.25, 1.25,
        -2, 0.25, 2,
        2, 0.25, 2,
        2, 0.25, 1.25,
        -1.25, 0.25, 1.25,

        -2, 0.25, -2,
        -1.25, 0.25, 1.25,
        -2, 0.25, 2,
        -2, 0.25, -2,
        -1.25, 0.25, -2,
        -1.25, 0.25, 1.25,

        // pavement

        2, 0.125, 1.25,
        1.25, 0.125, -1.25,
        -1.25, 0.125, 1.25,
        2, 0.125, 1.25,
        2, 0.125, -1.25,
        1.25, 0.125, -1.25,

        -1.25, 0.125, -2,
        1.25, 0.125, -1.25,
        -1.25, 0.125, 1.25,
        -1.25, 0.125, -2,
        1.25, 0.125, -2,
        1.25, 0.125, -1.25,

        // sidewalk

        2, 0.25, -1.25,
        2, 0.125, -1.25,
        1.25, 0.125, -1.25,
        1.25, 0.125, -1.25,
        1.25, 0.25, -1.25,
        2, 0.25, -1.25,

        1.25, 0.25, -2,
        1.25, 0.125, -2,
        1.25, 0.125, -1.25,
        1.25, 0.125, -1.25,
        1.25, 0.25, -1.25,
        1.25, 0.25, -2,

        2, 0.25, -1.25,
        2, 0.25, -2,
        1.25, 0.25, -1.25,
        1.25, 0.25, -2,
        2, 0.25, -2,
        1.25, 0.25, -1.25,

    ], [ 12, 13, 14, 15 ], [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 16, 17, 18, 19, 20, 21 ] )

}

export { RoadData }